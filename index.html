<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LeanBuild RaR Console</title>
  
  <!-- React 18 - UMD builds -->
  <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  
  <!-- Babel standalone for JSX transformation -->
  <script src="https://unpkg.com/@babel/standalone@7.23.5/babel.min.js"></script>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Lucide Icons - using the SVG sprite approach instead of React components -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            navy: '#0a1628',
            purple: '#8e6cfa',
            cyan: '#06b6d4',
            amber: '#f59e0b'
          }
        }
      }
    }
  </script>
  
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #f8fafc;
    }
    
    #root {
      min-height: 100vh;
    }
    
    *:focus {
      outline: 2px solid #06b6d4;
      outline-offset: 2px;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    // Icon component that uses inline SVG instead of lucide-react
    const Icon = ({ name, className = "", size = 24 }) => {
      const icons = {
        'trending-up': '<path d="M22 7L13.5 15.5L8.5 10.5L2 17M22 7H16M22 7V13"/>',
        'dollar-sign': '<path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>',
        'eye': '<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',
        'clock': '<circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/>',
        'alert-triangle': '<path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>',
        'calendar': '<rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>',
        'bell': '<path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/>',
        'trending-down': '<path d="m22 17-8.5-8.5-5 5L2 7"/><path d="M16 17h6v-6"/>',
        'arrow-up': '<line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/>',
        'arrow-down': '<line x1="12" y1="5" x2="12" y2="19"/><polyline points="19 12 12 19 5 12"/>',
        'check-circle-2': '<circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/>'
      };
      
      return (
        <svg 
          className={className} 
          width={size} 
          height={size} 
          viewBox="0 0 24 24" 
          fill="none" 
          stroke="currentColor" 
          strokeWidth="2" 
          strokeLinecap="round" 
          strokeLinejoin="round"
          dangerouslySetInnerHTML={{ __html: icons[name] || '' }}
        />
      );
    };

    // Simplified UI Components
    const Card = ({ className = "", children }) => (
      <div className={`rounded-lg border bg-white shadow-sm ${className}`}>
        {children}
      </div>
    );

    const CardHeader = ({ className = "", children }) => (
      <div className={`flex flex-col space-y-1.5 p-6 ${className}`}>
        {children}
      </div>
    );

    const CardTitle = ({ className = "", children }) => (
      <h3 className={`text-2xl font-semibold leading-none tracking-tight ${className}`}>
        {children}
      </h3>
    );

    const CardContent = ({ className = "", children }) => (
      <div className={`p-6 pt-0 ${className}`}>
        {children}
      </div>
    );

    const Badge = ({ className = "", variant = 'default', children }) => {
      const variants = {
        default: "bg-blue-100 text-blue-800",
        secondary: "bg-gray-100 text-gray-800",
        destructive: "bg-red-100 text-red-800",
        outline: "border border-gray-300 text-gray-700"
      };
      
      return (
        <span className={`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold ${variants[variant]} ${className}`}>
          {children}
        </span>
      );
    };

    const Button = ({ className = "", variant = 'default', size = 'default', children, ...props }) => {
      const variants = {
        default: "bg-blue-600 text-white hover:bg-blue-700",
        outline: "border border-gray-300 bg-white hover:bg-gray-50"
      };
      
      const sizes = {
        default: "h-10 px-4 py-2",
        sm: "h-9 px-3 text-sm"
      };
      
      return (
        <button 
          className={`inline-flex items-center justify-center gap-2 rounded-md font-medium transition-colors ${variants[variant]} ${sizes[size]} ${className}`}
          {...props}
        >
          {children}
        </button>
      );
    };

    const Progress = ({ value = 0, className = "" }) => (
      <div className={`relative h-4 w-full overflow-hidden rounded-full bg-gray-200 ${className}`}>
        <div 
          className="h-full bg-blue-600 transition-all"
          style={{ width: `${value}%` }}
        />
      </div>
    );

    const Alert = ({ className = "", children }) => (
      <div className={`relative w-full rounded-lg border p-4 ${className}`}>
        {children}
      </div>
    );

    const AlertDescription = ({ className = "", children }) => (
      <div className={`text-sm ${className}`}>
        {children}
      </div>
    );

    // Main RaR Console Component
    function RaRConsole() {
      const [sliderValue, setSliderValue] = useState(12);
      const [overallScore, setOverallScore] = useState(73);

      const calculateImpact = () => {
        const daysEarlier = sliderValue;
        const cashImpact = Math.round(33200 * (daysEarlier / 12));
        const scoreImprovement = Math.round(7 * (daysEarlier / 12));
        return { cashImpact, scoreImprovement };
      };

      const { cashImpact, scoreImprovement } = calculateImpact();

      const calendarDays = [
        { day: 'M', date: 1, status: 'good' },
        { day: 'T', date: 2, status: 'critical' },
        { day: 'W', date: 3, status: 'warning' },
        { day: 'T', date: 4, status: 'good' },
        { day: 'F', date: 5, status: 'good' },
        { day: 'S', date: 6, status: 'warning' },
        { day: 'S', date: 7, status: 'good' }
      ];

      const getStatusColor = (status) => {
        switch (status) {
          case 'critical': return 'bg-red-500';
          case 'warning': return 'bg-yellow-500';
          case 'good': return 'bg-green-500';
          default: return 'bg-gray-300';
        }
      };

      return (
        <div className="p-6 space-y-6 bg-gray-50">
          {/* Summary Header */}
          <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
            <Card className="bg-gradient-to-r from-blue-50 to-blue-100 border-blue-200">
              <CardContent className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-blue-600 font-medium">Overall RaR Score</p>
                    <p className="text-2xl font-bold text-blue-900">{overallScore}</p>
                  </div>
                  <Icon name="trending-up" className="text-blue-600" size={32} />
                </div>
                <Progress value={overallScore} className="mt-2" />
              </CardContent>
            </Card>

            <Card>
              <CardContent className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">Total at Risk</p>
                    <p className="text-2xl font-bold text-red-600">$77.3K</p>
                  </div>
                  <Icon name="dollar-sign" className="text-red-500" size={32} />
                </div>
                <div className="flex items-center mt-2 text-sm">
                  <Icon name="arrow-up" className="text-red-500 mr-1" size={16} />
                  <span className="text-red-600">+$14K from last week</span>
                </div>
              </CardContent>
            </Card>

            <Card>
              <CardContent className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">Active Blind Spots</p>
                    <p className="text-2xl font-bold text-orange-600">3</p>
                  </div>
                  <Icon name="eye" className="text-orange-500" size={32} />
                </div>
                <Badge variant="secondary" className="mt-2">2 Critical</Badge>
              </CardContent>
            </Card>

            <Card>
              <CardContent className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">Avg Payment Delay</p>
                    <p className="text-2xl font-bold text-yellow-600">47d</p>
                  </div>
                  <Icon name="clock" className="text-yellow-500" size={32} />
                </div>
                <div className="flex items-center mt-2 text-sm">
                  <Icon name="arrow-down" className="text-green-500 mr-1" size={16} />
                  <span className="text-green-600">-5d improvement</span>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* Main Dashboard */}
          <div className="grid grid-cols-1 gap-6 md:grid-cols-3">
            
            {/* Panel 1: Cash Flow Blind Spots */}
            <Card>
              <CardHeader className="pb-4">
                <div className="flex items-center space-x-2">
                  <Icon name="alert-triangle" className="text-orange-500" size={20} />
                  <CardTitle className="text-lg">Cash Flow Blind Spots</CardTitle>
                </div>
              </CardHeader>
              <CardContent className="space-y-4">
                
                <div>
                  <div className="text-sm font-medium mb-3">Accounts Overview</div>
                  <div className="grid grid-cols-1 gap-2 text-xs">
                    <div className="bg-red-50 border border-red-200 p-2 rounded flex justify-between items-center">
                      <span>AR Aging</span>
                      <Badge variant="destructive">Critical</Badge>
                    </div>
                    <div className="bg-yellow-50 border border-yellow-200 p-2 rounded flex justify-between items-center">
                      <span>Pending Pay Apps</span>
                      <Badge variant="secondary">3 Pending</Badge>
                    </div>
                    <div className="bg-green-50 border border-green-200 p-2 rounded flex justify-between items-center">
                      <span>Retainage Release</span>
                      <Badge variant="outline">On Track</Badge>
                    </div>
                  </div>
                </div>

                <div>
                  <div className="flex items-center space-x-2 mb-3">
                    <Icon name="calendar" size={16} />
                    <div className="text-sm font-medium">Heat Map Calendar</div>
                  </div>
                  
                  <div className="grid grid-cols-7 gap-1 mb-3">
                    {calendarDays.map((day, index) => (
                      <div key={index} className="text-center">
                        <div className="text-xs text-gray-500 mb-1">{day.day}</div>
                        <div className={`w-8 h-8 rounded flex items-center justify-center text-white text-xs font-medium ${getStatusColor(day.status)}`}>
                          {day.date}
                        </div>
                      </div>
                    ))}
                  </div>

                  <Alert className="border-red-200 bg-red-50">
                    <div className="flex items-start gap-2">
                      <Icon name="alert-triangle" className="text-red-600 mt-0.5" size={16} />
                      <AlertDescription>
                        <strong>July 2:</strong> Missing data from Subcontractor X
                      </AlertDescription>
                    </div>
                  </Alert>
                </div>

                <div className="flex justify-between items-center pt-2 border-t">
                  <div className="text-xs text-red-600 font-medium">
                    Blind Spot Impact: -10 RaR points
                  </div>
                  <Button size="sm" variant="outline">
                    <Icon name="bell" size={16} className="mr-1" />
                    Set Alert
                  </Button>
                </div>
              </CardContent>
            </Card>

            {/* Panel 2: Payment Delays */}
            <Card>
              <CardHeader className="pb-4">
                <div className="flex items-center space-x-2">
                  <Icon name="clock" className="text-red-500" size={20} />
                  <CardTitle className="text-lg">Payment Delays</CardTitle>
                </div>
              </CardHeader>
              <CardContent className="space-y-4">
                
                <div>
                  <div className="text-sm font-medium mb-3">Overdue Invoices</div>
                  <div className="space-y-3">
                    <Card className="border-red-200 bg-red-50">
                      <CardContent className="p-3">
                        <div className="flex justify-between items-start mb-2">
                          <div className="text-sm font-medium">Invoice #2023-41</div>
                          <Badge variant="destructive">61 Days</Badge>
                        </div>
                        <div className="text-lg font-bold text-red-600 mb-2">$63,000</div>
                        <div className="flex justify-between items-center">
                          <span className="text-xs text-gray-600">Owner rejected Line Item 5</span>
                          <Button size="sm" variant="outline">Follow Up</Button>
                        </div>
                      </CardContent>
                    </Card>

                    <Card className="border-yellow-200 bg-yellow-50">
                      <CardContent className="p-3">
                        <div className="flex justify-between items-start mb-2">
                          <div className="text-sm font-medium">Invoice #2023-52</div>
                          <Badge variant="secondary">32 Days</Badge>
                        </div>
                        <div className="text-lg font-bold text-yellow-600 mb-2">$14,300</div>
                        <div className="flex justify-between items-center">
                          <span className="text-xs text-gray-600">Pending review</span>
                          <Button size="sm" variant="outline">Contact</Button>
                        </div>
                      </CardContent>
                    </Card>
                  </div>
                </div>

                <div className="flex justify-between items-center pt-2 border-t">
                  <div className="text-xs text-red-600 font-medium">
                    Delay Penalty: -6.1 RaR points
                  </div>
                  <div className="text-xs text-gray-500">
                    Avg: 47 days
                  </div>
                </div>
              </CardContent>
            </Card>

            {/* Panel 3: Risk Anticipation */}
            <Card>
              <CardHeader className="pb-4">
                <div className="flex items-center space-x-2">
                  <Icon name="trending-down" className="text-purple-500" size={20} />
                  <CardTitle className="text-lg">Risk Anticipation</CardTitle>
                </div>
              </CardHeader>
              <CardContent className="space-y-4">
                
                <div>
                  <div className="text-sm font-medium mb-3">Recent Shortfall</div>
                  <Alert className="border-orange-200 bg-orange-50">
                    <div className="flex items-start gap-2">
                      <Icon name="alert-triangle" className="text-orange-600 mt-0.5" size={16} />
                      <AlertDescription>
                        <strong>Retainage Alert:</strong> Fired 12 days too late
                        <div className="text-xs text-gray-600 mt-1">
                          Cost: $33,200 in delayed cash flow
                        </div>
                      </AlertDescription>
                    </div>
                  </Alert>
                </div>

                <div>
                  <div className="text-sm font-medium mb-3">What If Simulation</div>
                  <div className="space-y-3">
                    <div>
                      <div className="flex justify-between text-xs text-gray-600 mb-1">
                        <span>Alert {sliderValue} days earlier</span>
                        <span>Current: 12 days late</span>
                      </div>
                      <input 
                        type="range"
                        min="0"
                        max="30"
                        value={sliderValue}
                        onChange={(e) => setSliderValue(parseInt(e.target.value))}
                        className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"
                      />
                    </div>

                    <Card className="bg-green-50 border-green-200">
                      <CardContent className="p-3">
                        <div className="text-sm font-medium text-green-800 mb-1">
                          Projected Impact
                        </div>
                        <div className="grid grid-cols-2 gap-2 text-xs">
                          <div>
                            <div className="text-gray-600">RaR Score</div>
                            <div className="font-bold text-green-600">+{scoreImprovement}</div>
                          </div>
                          <div>
                            <div className="text-gray-600">Cash Impact</div>
                            <div className="font-bold text-green-600">+${cashImpact.toLocaleString()}</div>
                          </div>
                        </div>
                      </CardContent>
                    </Card>
                  </div>
                </div>

                <div className="space-y-2">
                  <Button className="w-full" variant="default">
                    <Icon name="check-circle-2" size={16} className="mr-2" />
                    Enable Smart Alerts
                  </Button>
                  <Button className="w-full" variant="outline">
                    Configure Automation
                  </Button>
                </div>

                <div className="text-xs text-purple-600 font-medium pt-2 border-t">
                  Potential RaR Gain: +{scoreImprovement} points
                </div>
              </CardContent>
            </Card>
          </div>
        </div>
      );
    }

    // Render the app
    const container = document.getElementById('root');
    const root = ReactDOM.createRoot(container);
    root.render(<RaRConsole />);
  </script>
</body>
</html>
